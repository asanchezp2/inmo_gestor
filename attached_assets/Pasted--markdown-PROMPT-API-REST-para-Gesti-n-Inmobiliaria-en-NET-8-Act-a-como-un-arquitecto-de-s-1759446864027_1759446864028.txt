```markdown
# PROMPT: API REST para GestiÃ³n Inmobiliaria en .NET 8

ActÃºa como un arquitecto de software senior especializado en .NET y sistemas inmobiliarios. Tu objetivo es generar una aplicaciÃ³n completa, funcional y lista para ejecutar desde el primer intento.

## ğŸ¯ OBJETIVO
Desarrollar una API REST en .NET 8 para gestiÃ³n de propiedades inmobiliarias con arquitectura en capas, cÃ³digo limpio y deployment containerizado.

## ğŸ“‹ ESPECIFICACIONES TÃ‰CNICAS

### Stack TecnolÃ³gico
- **.NET 8** (Web API)
- **SQL Server** como base de datos
- **Entity Framework Core** para ORM
- **Swagger/OpenAPI** para documentaciÃ³n
- **Docker** para containerizaciÃ³n

### Arquitectura
- **PatrÃ³n en capas**: Presentation (API) â†’ Application (Services) â†’ Domain (Entities) â†’ Infrastructure (Data Access)
- **Repository Pattern** para acceso a datos
- **DTOs** para transferencia de datos
- **AutoMapper** para mapeo de objetos
- **IMPORTANTE**: Un solo proyecto .csproj con las capas organizadas como carpetas (NO proyectos separados) para mayor agilidad en desarrollo y pruebas locales

### Seguridad (Fase 1)
- **SIN autenticaciÃ³n** por ahora (prototipo funcional)
- Preparar estructura para futura implementaciÃ³n de API Key en appsettings.json

## ğŸ—ï¸ MODELO DE DATOS

### Entidad: Propiedad (Property)
```csharp
- PropertyId: string (PK) // Formato: "TIPO-ZONA-NUMERO" ej: "CASA-NORTE-12345"
- PropertyCode: string (Ãºnico) // CÃ³digo interno generado automÃ¡ticamente
- Type: enum (Terreno, Casa, Departamento, LocalComercial, Oficina)
- Status: enum (EnVenta, EnAlquiler, EnAnticredito, Vendido, NoDisponible)
- Title: string (100 caracteres max)
- Description: string (1000 caracteres max)
- Price: decimal(18,2)
- Area: decimal(10,2) // Metros cuadrados
- Zone: enum (Norte, Sur, Este, Oeste, Centro)
- Address: string (200 caracteres max)
- Bedrooms: int? (nullable, solo para Casa/Departamento)
- Bathrooms: int? (nullable)
- ParkingSpots: int? (nullable)
- HasImages: bool // Indica si tiene imÃ¡genes
- ImageUrls: string (JSON array serializado) // URLs de imÃ¡genes (max 10)
- AvailableDate: DateTime
- ClosedDate: DateTime? (nullable) // Fecha de venta/baja
- CreatedAt: DateTime
- UpdatedAt: DateTime
- AdvisorId: int (FK)
```

### Entidad: Asesor (Advisor)
```csharp
- AdvisorId: int (PK, Identity)
- FullName: string (100 caracteres max, requerido)
- Email: string? (nullable, validar formato)
- PrimaryPhone: string (20 caracteres max, requerido)
- SecondaryPhone: string? (nullable)
- IsActive: bool (default: true)
- CreatedAt: DateTime
```

### Relaciones
- Un Asesor puede tener muchas Propiedades (1:N)

## ğŸ”§ ENDPOINTS REQUERIDOS

### Propiedades
```
POST   /api/properties              - Crear propiedad
GET    /api/properties              - Listar con paginaciÃ³n y filtros
GET    /api/properties/{id}         - Obtener por ID
PUT    /api/properties/{id}         - Actualizar propiedad
PATCH  /api/properties/{id}/status  - Cambiar estado
DELETE /api/properties/{id}         - Eliminar (soft delete recomendado)

# Filtros para GET /api/properties:
- ?type=Casa
- ?status=EnVenta
- ?minPrice=100000&maxPrice=500000
- ?zone=Norte
- ?minArea=50&maxArea=200
- ?advisorId=1
- ?page=1&pageSize=20
```

### Asesores
```
POST   /api/advisors                - Crear asesor
GET    /api/advisors                - Listar todos
GET    /api/advisors/{id}           - Obtener por ID
PUT    /api/advisors/{id}           - Actualizar asesor
GET    /api/advisors/{id}/properties - Propiedades de un asesor
```

## âœ… REGLAS DE NEGOCIO

1. **PropertyCode** se genera automÃ¡ticamente: `{TIPO}-{ZONA}-{5_DIGITOS_ALEATORIOS}` (ej: "CASA-NORTE-47382")
2. Una propiedad **Vendida o NoDisponible** debe registrar `ClosedDate` automÃ¡ticamente
3. No se puede cambiar estado de **Vendido** a **EnVenta** (una venta es definitiva para esa propiedad)
4. Si se revende, debe crearse una **nueva propiedad**
5. `Price` y `Area` deben ser mayores a 0
6. `AvailableDate` no puede ser anterior a `CreatedAt`
7. Al menos un telÃ©fono (Primary o Secondary) es obligatorio para Advisor
8. Validar formato de email si se proporciona

## ğŸ“¦ ESTRUCTURA DEL PROYECTO

```
RealEstateAPI/
â”œâ”€â”€ RealEstateAPI.sln                # SoluciÃ³n de Visual Studio
â”œâ”€â”€ RealEstateAPI/                   # Proyecto Ãºnico .csproj
â”‚   â”œâ”€â”€ Controllers/                 # Capa de presentaciÃ³n
â”‚   â”œâ”€â”€ Application/                 # LÃ³gica de aplicaciÃ³n
â”‚   â”‚   â”œâ”€â”€ DTOs/
â”‚   â”‚   â”œâ”€â”€ Interfaces/
â”‚   â”‚   â”œâ”€â”€ Services/
â”‚   â”‚   â”œâ”€â”€ Mappings/
â”‚   â”‚   â””â”€â”€ Validators/
â”‚   â”œâ”€â”€ Domain/                      # Entidades y lÃ³gica de dominio
â”‚   â”‚   â”œâ”€â”€ Entities/
â”‚   â”‚   â”œâ”€â”€ Enums/
â”‚   â”‚   â””â”€â”€ Interfaces/
â”‚   â”œâ”€â”€ Infrastructure/              # Acceso a datos
â”‚   â”‚   â”œâ”€â”€ Data/
â”‚   â”‚   â”‚   â”œâ”€â”€ ApplicationDbContext.cs
â”‚   â”‚   â”‚   â””â”€â”€ Seed/
â”‚   â”‚   â”œâ”€â”€ Repositories/
â”‚   â”‚   â””â”€â”€ Configurations/
â”‚   â”œâ”€â”€ Middlewares/
â”‚   â”œâ”€â”€ Program.cs
â”‚   â”œâ”€â”€ appsettings.json
â”‚   â”œâ”€â”€ appsettings.Development.json
â”‚   â”œâ”€â”€ RealEstateAPI.csproj
â”‚   â””â”€â”€ Dockerfile
â””â”€â”€ docker-compose.yml
```

## âš™ï¸ CONFIGURACIÃ“N REQUERIDA

### appsettings.json
```json
{
  "ConnectionStrings": {
    "DefaultConnection": "Server=localhost,1433;Database=RealEstateDB;User Id=sa;Password=YourStrong@Passw0rd;TrustServerCertificate=True;"
  },
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning"
    }
  },
  "AllowedHosts": "*",
  "ApiSettings": {
    "Version": "v1",
    "Title": "Real Estate API",
    "Description": "API para gestiÃ³n de propiedades inmobiliarias"
  }
}
```

### appsettings.Development.json
```json
{
  "ConnectionStrings": {
    "DefaultConnection": "Server=sqlserver;Database=RealEstateDB;User Id=sa;Password=YourStrong@Passw0rd;TrustServerCertificate=True;"
  }
}
```

## ğŸ³ DOCKER

### Dockerfile (para API)
- Multi-stage build
- Usar imagen `mcr.microsoft.com/dotnet/aspnet:8.0` para runtime
- Exponer puerto 8080

### docker-compose.yml
```yaml
services:
  sqlserver:
    - SQL Server 2022
    - Persistencia con volumen
    - Puerto 1433
  
  api:
    - Depende de sqlserver
    - Espera a que SQL Server estÃ© listo
    - Puerto 5000:8080
    - Variables de entorno para ConnectionString
```

## ğŸ“Š DATOS DE PRUEBA (SEED DATA)

Generar automÃ¡ticamente al ejecutar migraciones:
- **5 Asesores** con datos realistas
- **20 Propiedades** variadas:
  - Diferentes tipos, estados, zonas
  - Precios entre $50,000 y $5,000,000
  - Ãreas entre 30mÂ² y 500mÂ²
  - Distribuidas entre los asesores
  - Algunas con imÃ¡genes de ejemplo (URLs de placeholder)

## ğŸ“ ENTREGABLES

Genera TODO lo siguiente en UN SOLO RESPONSE:

1. **RealEstateAPI.sln** (archivo de soluciÃ³n)
2. **RealEstateAPI.csproj** con todas las dependencias necesarias
3. **CÃ³digo completo** de todas las capas organizadas en carpetas
4. **Program.cs** configurado (DI, Swagger, EF Core, CORS)
5. **ApplicationDbContext** con configuraciones Fluent API
6. **Migraciones** (comandos a ejecutar)
7. **Dockerfile** optimizado
8. **docker-compose.yml** funcional
9. **README.md** con:
   - Instrucciones de ejecuciÃ³n
   - Endpoints disponibles
   - Ejemplos de requests con cURL
   - Comandos Docker
10. **.gitignore** para .NET

## ğŸ¨ REQUISITOS DE CALIDAD

- **CÃ³digo limpio**: nombres descriptivos, mÃ©todos cortos, principios SOLID
- **Comentarios**: solo en lÃ³gica compleja
- **Manejo de errores**: try-catch, responses HTTP apropiados
- **Validaciones**: FluentValidation o Data Annotations
- **Logging**: usar ILogger
- **PaginaciÃ³n**: implementar en listados
- **DTOs separados**: Request/Response diferentes de entidades
- **AutoMapper**: configurado y funcional

## ğŸš€ CRITERIOS DE Ã‰XITO

La aplicaciÃ³n debe:
âœ… Compilar sin errores  
âœ… Ejecutarse con `docker-compose up`  
âœ… Crear base de datos automÃ¡ticamente  
âœ… Cargar datos de prueba  
âœ… Swagger accesible en `http://localhost:5000/swagger`  
âœ… Todos los endpoints funcionales  
âœ… Respuestas JSON correctamente formateadas  
âœ… Validaciones funcionando  

---

**IMPORTANTE**: Genera TODO el cÃ³digo necesario. No uses placeholders como "// Implementar aquÃ­". Cada archivo debe estar completo y listo para copiar/pegar. La aplicaciÃ³n debe funcionar al 100% despuÃ©s de seguir las instrucciones del README. Recuerda: UN SOLO PROYECTO .csproj con arquitectura en capas mediante carpetas.
```